{% function block.render_table(data, header, highlight) %}
  <div id="tags">
  <table>
  {% for i = 1,#header do %}
  <th>{%& header[i] %}</th>
  {% end %}
  {% for k,v in pairs(data) do %}
    <tr>
    {% for i,j in pairs(v) do %}
      <td {% if j == highlight then %}class="active"{% end %}>{%& j %}</td>
    {% end %}
    </tr>
  {% end %}
  </table>
  </div>
{% end %}

{% function block.content() %}
{% if #tag > 0 then %}
  {% local tag_count = vars.get_tag_count(tag) %}
  <p>
  {% if tag_count > 1 then %}
    We have found {%& tag_count %} pages with tag '{%& tag %}'
  {% elseif tag_count == 1 then %}
    We have found 1 page with tag '{%& tag %}'
  {% else %}
    No pages with '{%& tag %}' have been found!
  </p>
  {% end %}
{% block.render_table(vars.pdfs_by_tag(tag), {"id", "page number"}, '') %}
{% else %}
{% block.render_table(vars.get_all_tags(), {"count", "tag"}, tag) %}
{% end %}

{% end %}

{% render('base', {current_page="tags"}) %}
